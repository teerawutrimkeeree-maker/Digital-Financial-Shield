<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>เกราะป้องกันการเงินดิจิทัล</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Sarabun', sans-serif;
        background: linear-gradient(180deg, rgb(255, 255, 255), rgb(195, 240, 200), rgb(80, 155, 245));
        background-attachment: fixed;
      }
    </style>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "@google/genai": "https://esm.sh/@google/genai"
      }
    }
    </script>
</head>
<body>
    <div id="root"></div>
    <script type="module">
        import React, { useState, useEffect, useMemo } from 'react';
        import ReactDOM from 'react-dom/client';
        import { GoogleGenAI } from "@google/genai";

        // --- Start: types.ts ---
        const ActivityType = {
          Info: 'info',
          Quiz: 'quiz',
          Simulation: 'simulation',
          Game: 'game',
          Workshop: 'workshop',
          Reflection: 'reflection',
          Project: 'project'
        };
        // --- End: types.ts ---

        // --- Start: components/icons/Icons.tsx ---
        const ShieldCheckIcon = (props) => (
          React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
            React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.751h-.152c-3.196 0-6.1-1.249-8.25-3.286Z" })
          )
        );

        const LockClosedIcon = (props) => (
            React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
                React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z" })
            )
        );

        const CurrencyDollarIcon = (props) => (
            React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
                React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182.553-.44 1.282-.659 2.003-.659.725 0 1.45.22 2.003.659l.879.659m-8.683 4.253.586 4.472A2.25 2.25 0 0 0 7.86 19.5h8.28a2.25 2.25 0 0 0 2.247-2.316l.586-4.472M6.75 12h10.5" })
            )
        );

        const LightBulbIcon = (props) => (
            React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
                React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.311a7.5 7.5 0 0 1-7.5 0c.246.316.498.632.756.948h6.988c.258-.316.51-.632.756-.948ZM12 18.75a9.75 9.75 0 0 0 6-2.25M12 18.75a9.75 9.75 0 0 1-6-2.25m10.5-11.25c.621 0 1.125-.504 1.125-1.125V6c0-.621-.504-1.125-1.125-1.125H9.375c-.621 0-1.125.504-1.125 1.125v1.625c0 .621.504 1.125 1.125 1.125h5.25Z" })
            )
        );

        const TrophyIcon = (props) => (
            React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
                React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M16.5 18.75h-9a2.25 2.25 0 0 1-2.25-2.25v-6.75a2.25 2.25 0 0 1 2.25-2.25h9a2.25 2.25 0 0 1 2.25 2.25v6.75a2.25 2.25 0 0 1-2.25-2.25Z" }),
                React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M6.75 12.75H4.875c-.621 0-1.125.504-1.125 1.125v2.25c0 .621.504 1.125 1.125 1.125h1.875m9.75 0h1.875c.621 0 1.125-.504 1.125-1.125v-2.25c0-.621-.504-1.125-1.125-1.125H17.25M12 15V6.375m0 0L15 9.375m-3-3L9 9.375" })
            )
        );

        const CheckCircleIcon = (props) => (
            React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
                React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" })
            )
        );

        const XCircleIcon = (props) => (
            React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
                React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" })
            )
        );

        const ArrowLeftIcon = (props) => (
            React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
                React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" })
            )
        );
        // --- End: components/icons/Icons.tsx ---

        // --- Start: data/modulesData.ts ---
        const modules = [
          {
            id: 1,
            title: "รู้ทันกลโกงออนไลน์",
            subtitle: "Online Scam Awareness",
            objective: "นักเรียนสามารถแยกแยะและรับมือกับการหลอกลวงในรูปแบบต่าง ๆ ได้",
            icon: ShieldCheckIcon,
            activities: [
              {
                type: ActivityType.Info,
                title: "ประเภทของการหลอกลวง",
                description: "เรียนรู้กลโกงยอดนิยมที่มิจฉาชีพใช้",
                content: [
                  "Phishing: การหลอกลวงเพื่อขโมยข้อมูลส่วนตัว เช่น รหัสผ่าน หรือข้อมูลบัตรเครดิต โดยการสร้างหน้าเว็บปลอมที่ดูเหมือนจริง",
                  "Fake News: ข่าวปลอมที่สร้างขึ้นเพื่อสร้างความเข้าใจผิดหรือหวังผลประโยชน์บางอย่าง",
                  "Investment Scam: การหลอกให้ลงทุนในสิ่งที่ให้ผลตอบแทนสูงเกินจริงและไม่มีอยู่จริง",
                  "Romance Scam: การสร้างความสัมพันธ์ออนไลน์เพื่อหลอกลวงให้โอนเงิน",
                ],
              },
              {
                type: ActivityType.Simulation,
                title: "จำลองแชทจาก Scammer",
                description: "ทดลองตอบโต้กับมิจฉาชีพในสถานการณ์จำลองเพื่อเรียนรู้วิธีรับมือ",
              },
              {
                type: ActivityType.Quiz,
                title: "แบบทดสอบ: สถานการณ์ฉุกเฉิน",
                description: "ทดสอบความเข้าใจในการรับมือกับกลโกง",
                questions: [
                  {
                    question: "คุณได้รับ SMS แจ้งว่า 'คุณได้รับรางวัล 100,000 บาท! คลิกลิงก์นี้เพื่อรับสิทธิ์ทันที' คุณควรทำอย่างไร?",
                    options: [
                      { text: "คลิกลิงก์ทันที กลัวเสียสิทธิ์", isCorrect: false, feedback: "การคลิกลิงก์ที่ไม่รู้จักมีความเสี่ยงสูง อาจเป็นการดักขโมยข้อมูล" },
                      { text: "ลบ SMS ทิ้งและไม่สนใจ", isCorrect: true, feedback: "ถูกต้อง! ข้อความที่น่าสงสัยและให้ผลตอบแทนดีเกินจริงมักเป็นกลโกง" },
                      { text: "โทรกลับไปที่เบอร์นั้นเพื่อสอบถาม", isCorrect: false, feedback: "ไม่ควรโทรกลับเบอร์ที่ไม่รู้จัก อาจทำให้คุณตกเป็นเป้าหมายมากขึ้น" },
                    ],
                  },
                ],
              },
              {
                type: ActivityType.Reflection,
                title: "บันทึกการเรียนรู้",
                description: "หลังจากเรียนรู้แล้ว, บันทึกสิ่งที่คุณจะนำไปใช้จริงเพื่อป้องกันตัวเองจากกลโกงออนไลน์",
              },
            ],
            badgeId: "scam-awareness-badge",
          },
          {
            id: 2,
            title: "จัดการข้อมูลส่วนตัว",
            subtitle: "Digital Privacy & Security",
            objective: "นักเรียนรู้จักปกป้องข้อมูลส่วนตัวในโลกออนไลน์",
            icon: LockClosedIcon,
            activities: [
              {
                type: ActivityType.Info,
                title: "ความสำคัญของข้อมูลส่วนบุคคล",
                description: "ข้อมูลอะไรบ้างที่สำคัญและทำไมเราต้องปกป้อง",
                content: [
                  "ข้อมูลที่ระบุตัวตนได้โดยตรง: เลขบัตรประชาชน, ชื่อ-นามสกุล, ที่อยู่, เบอร์โทรศัพท์",
                  "ข้อมูลทางการเงิน: เลขบัญชีธนาคาร, รหัสบัตรเครดิต, รหัสผ่านแอปธนาคาร",
                  "ความเสี่ยงเมื่อข้อมูลรั่วไหล: การถูกสวมรอย, การสูญเสียทรัพย์สิน, การถูกคุกคาม",
                ],
              },
              {
                type: ActivityType.Workshop,
                title: "Workshop: สร้างรหัสผ่านที่ปลอดภัย",
                description: "ลองสร้างรหัสผ่านและทดสอบความแข็งแรงของมัน",
                gameType: 'passwordChecker'
              },
              {
                type: ActivityType.Game,
                title: "เกม: ควรแชร์หรือไม่ควรแชร์?",
                description: "จัดหมวดหมู่ข้อมูลที่ควรและไม่ควรแชร์บนโลกออนไลน์",
                gameType: 'shareSort'
              },
              {
                type: ActivityType.Quiz,
                title: "Interactive Quiz",
                description: "ทดสอบความรู้เรื่องความเป็นส่วนตัว",
                questions: [
                  {
                    question: "ข้อใดคือลักษณะของรหัสผ่านที่คาดเดาได้ยาก?",
                    options: [
                      { text: "ใช้ชื่อเล่นและวันเกิด", isCorrect: false },
                      { text: "12345678", isCorrect: false },
                      { text: "มีตัวอักษรใหญ่, เล็ก, ตัวเลข, และสัญลักษณ์ผสมกัน", isCorrect: true },
                      { text: "ใช้คำศัพท์ที่มีในพจนานุกรม", isCorrect: false },
                    ],
                  },
                ],
              },
            ],
            badgeId: "privacy-security-badge",
          },
          {
            id: 3,
            title: "การเงินฉลาดใช้",
            subtitle: "Financial Literacy Basics",
            objective: "นักเรียนเข้าใจพื้นฐานการจัดการการเงินส่วนบุคคล",
            icon: CurrencyDollarIcon,
            activities: [
              {
                type: ActivityType.Info,
                title: "พื้นฐานการเงิน",
                description: "เรียนรู้เรื่อง รายรับ-รายจ่าย, ความต้องการ vs ความจำเป็น",
                content: [
                  "รายรับ: เงินที่ได้มา เช่น เงินค่าขนม, เงินเดือน",
                  "รายจ่าย: เงินที่ใช้ไป เช่น ค่าอาหาร, ค่าเดินทาง, ค่าของเล่น",
                  "ความจำเป็น (Needs): สิ่งที่ขาดไม่ได้ในการดำรงชีวิต เช่น อาหาร, ที่อยู่",
                  "ความต้องการ (Wants): สิ่งที่อยากได้แต่ไม่จำเป็น เช่น ของเล่นใหม่, เสื้อผ้าแฟชั่น",
                ],
              },
              {
                type: ActivityType.Game,
                title: "จำลอง: งบประมาณชีวิตนักเรียน",
                description: "บริหารจัดการเงินค่าขนมที่ได้รับในหนึ่งสัปดาห์",
                gameType: 'budget'
              },
              {
                type: ActivityType.Reflection,
                title: "แผนการออมของฉัน",
                description: "บันทึกเป้าหมายการออมและวางแผนว่าจะทำอย่างไรให้สำเร็จ",
              },
            ],
            badgeId: "financial-literacy-badge",
          },
          {
            id: 4,
            title: "คิดก่อนคลิก คิดก่อนใช้",
            subtitle: "Smart Decision-Making",
            objective: "นักเรียนพัฒนาทักษะการคิดวิเคราะห์และตัดสินใจอย่างมีเหตุผล",
            icon: LightBulbIcon,
            activities: [
              {
                type: ActivityType.Info,
                title: "หลักการคิดเชิงวิพากษ์ (Critical Thinking)",
                description: "เรียนรู้วิธีตั้งคำถามและประเมินข้อมูลก่อนตัดสินใจ",
                content: [
                    "ใครคือผู้สร้างข้อมูลนี้?",
                    "พวกเขามีเจตนาอะไร?",
                    "ข้อมูลนี้ทำให้เรารู้สึกอย่างไร?",
                    "มีแหล่งข้อมูลอื่นที่ยืนยันเรื่องนี้หรือไม่?",
                ]
              },
              {
                type: ActivityType.Quiz,
                title: "เกม Role Play: ข้อเสนอการลงทุน",
                description: "เมื่อเจอโฆษณาชวนลงทุน คุณจะตัดสินใจอย่างไร?",
                questions: [
                  {
                    question: "เพื่อนมาชวนลงทุนใน 'เหรียญดิจิทัลเปิดใหม่' การันตีผลตอบแทน 30% ต่อเดือน คุณควรทำอย่างไรเป็นอันดับแรก?",
                    options: [
                      { text: "ลงทุนทันที เพราะเพื่อนชวนและผลตอบแทนดีมาก", isCorrect: false, feedback: "การลงทุนตามเพื่อนโดยไม่ศึกษาข้อมูลเป็นความเสี่ยงสูงมาก" },
                      { text: "ปฏิเสธทันที เพราะดูน่ากลัวเกินไป", isCorrect: false, feedback: "การปฏิเสธทันทีอาจทำให้พลาดโอกาสที่ดีได้ แต่การตรวจสอบก่อนเป็นสิ่งที่ดีที่สุด" },
                      { text: "ขอบคุณเพื่อน และขอกลับไปตรวจสอบข้อมูลความน่าเชื่อถือของเหรียญนั้นก่อน", isCorrect: true, feedback: "ยอดเยี่ยม! การตรวจสอบข้อมูลจากหลายๆ แหล่งก่อนตัดสินใจลงทุนเป็นสิ่งที่สำคัญที่สุด" },
                    ],
                  },
                ]
              },
            ],
            badgeId: "decision-making-badge",
          },
          {
            id: 5,
            title: "ชีวิตดิจิทัลอย่างปลอดภัยและยั่งยืน",
            subtitle: "My Safe & Smart Digital Life",
            objective: "นักเรียนสรุปและประยุกต์ใช้สิ่งที่เรียนมาในชีวิตจริง",
            icon: TrophyIcon,
            activities: [
              {
                type: ActivityType.Info,
                title: "สรุป 5 เทคนิคหลัก",
                description: "ทบทวนเคล็ดลับสำคัญในการใช้ชีวิตดิจิทัลอย่างปลอดภัย",
                content: [
                  "1. ตรวจสอบก่อนเชื่อ: อย่าเชื่อทุกอย่างที่เห็นในอินเทอร์เน็ต",
                  "2. คิดก่อนคลิก: ลิงก์แปลกปลอมอาจนำไปสู่ไวรัสหรือการขโมยข้อมูล",
                  "3. ปกป้องข้อมูลส่วนตัว: ตั้งรหัสผ่านให้แข็งแกร่งและไม่แชร์ข้อมูลสำคัญ",
                  "4. แยกแยะความต้องการและความจำเป็น: ใช้เงินอย่างมีสติ",
                  "5. ออมก่อนใช้: สร้างวินัยทางการเงินเพื่ออนาคต",
                ]
              },
              {
                type: ActivityType.Project,
                title: "Mini Project: เคล็ดลับการเงินปลอดภัย",
                description: "ออกแบบ Infographic หรือวิดีโอสั้นเพื่อแบ่งปันเคล็ดลับที่คุณได้เรียนรู้ให้กับเพื่อนๆ",
              },
              {
                type: ActivityType.Reflection,
                title: "ฉันพัฒนาตัวเองอย่างไร",
                description: "บันทึกสิ่งที่คุณได้เรียนรู้และคุณจะนำไปปรับใช้ในชีวิตประจำวันอย่างไรบ้าง",
              },
            ],
            badgeId: "digital-life-badge",
          },
        ];
        // --- End: data/modulesData.ts ---
        
        // --- Start: services/geminiService.ts ---
        const ai = new GoogleGenAI({ apiKey: "AIzaSyC8bWJUVQ4xhU-bp00Iv-T97f5aapXTcFc" });

        const generateScammerResponse = async (chatHistory) => {
          try {
            const model = 'gemini-2.5-flash';
            const systemInstruction = `You are a scammer in a chat simulation for an educational app. Your goal is to trick the user.
            - Use common scam techniques: create urgency, appeal to emotions (greed, fear, romance), and make offers that are too good to be true.
            - Your personality is charming but manipulative.
            - Keep your responses short and conversational, like a real chat message.
            - Adapt your scamming strategy based on the user's responses.
            - Your current scam is a fake investment opportunity.`;
            
            const contents = chatHistory.map(message => ({
                role: message.role,
                parts: [{ text: message.text }]
            }));

            const response = await ai.models.generateContent({
              model: model,
              contents: contents,
              config: {
                systemInstruction: systemInstruction,
              },
            });

            return response.text;
          } catch (error) {
            console.error("Error generating Gemini response:", error);
            return "ขออภัย, ระบบขัดข้อง โปรดลองอีกครั้งในภายหลัง (Error: Unable to connect to AI)";
          }
        };
        // --- End: services/geminiService.ts ---

        // --- Start: components/ActivityRenderer.tsx ---
        const QuizActivity = ({ questions, onComplete }) => {
          const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
          const [selectedOption, setSelectedOption] = useState(null);
          const [showFeedback, setShowFeedback] = useState(false);
          const [score, setScore] = useState(0);

          const question = questions[currentQuestionIndex];

          const handleOptionSelect = (index) => {
            if (showFeedback) return;
            setSelectedOption(index);
            setShowFeedback(true);
            if (question.options[index].isCorrect) {
              setScore(score + 1);
            }
          };

          const handleNext = () => {
            if (currentQuestionIndex < questions.length - 1) {
              setCurrentQuestionIndex(currentQuestionIndex + 1);
              setSelectedOption(null);
              setShowFeedback(false);
            } else {
              onComplete();
            }
          };

          return React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md" },
            React.createElement('p', { className: "text-lg font-semibold text-gray-800 mb-4" }, question.question),
            React.createElement('div', { className: "space-y-3" },
              question.options.map((option, index) => {
                const isSelected = selectedOption === index;
                const isCorrect = option.isCorrect;
                const feedbackClass = isSelected
                  ? isCorrect
                    ? 'bg-green-100 border-green-500 text-green-800'
                    : 'bg-red-100 border-red-500 text-red-800'
                  : 'bg-white border-gray-300 hover:bg-gray-100';

                return React.createElement('button', {
                  key: index,
                  onClick: () => handleOptionSelect(index),
                  disabled: showFeedback,
                  className: `w-full text-left p-4 border rounded-lg transition-all duration-200 ${feedbackClass} ${showFeedback ? 'cursor-not-allowed' : 'cursor-pointer'}`
                },
                  React.createElement('div', { className: "flex items-center justify-between" },
                    React.createElement('span', null, option.text),
                    showFeedback && isSelected && (
                      isCorrect ? React.createElement(CheckCircleIcon, { className: "w-6 h-6 text-green-500" }) : React.createElement(XCircleIcon, { className: "w-6 h-6 text-red-500" })
                    )
                  ),
                  showFeedback && isSelected && option.feedback &&
                    React.createElement('p', { className: "text-sm mt-2 text-gray-600" }, option.feedback)
                );
              })
            ),
            showFeedback && React.createElement('div', { className: "mt-6 text-right" },
              React.createElement('button', {
                onClick: handleNext,
                className: "bg-blue-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-600 transition-colors"
              }, currentQuestionIndex < questions.length - 1 ? 'ข้อถัดไป' : 'เสร็จสิ้น')
            )
          );
        };

        const ChatSimulationActivity = ({ onComplete }) => {
            const [messages, setMessages] = useState([
                { author: 'bot', text: 'สวัสดีครับ! ผมเป็นที่ปรึกษาการลงทุน สนใจโปรเจกต์ใหม่ที่ให้ผลตอบแทน 300% ในเดือนเดียวไหมครับ?' }
            ]);
            const [userInput, setUserInput] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [isFinished, setIsFinished] = useState(false);

            const handleSendMessage = async (e) => {
                e.preventDefault();
                if (!userInput.trim() || isLoading) return;

                const newMessages = [...messages, { author: 'user', text: userInput }];
                setMessages(newMessages);
                setUserInput('');
                setIsLoading(true);

                const chatHistory = newMessages.map(m => ({ role: m.author === 'user' ? 'user' : 'model', text: m.text }));
                const botResponseText = await generateScammerResponse(chatHistory);
                
                setMessages(prev => [...prev, { author: 'bot', text: botResponseText }]);
                setIsLoading(false);
                
                if (newMessages.length >= 5) {
                     setIsFinished(true);
                }
            };

            return React.createElement('div', { className: "bg-white p-4 sm:p-6 rounded-lg shadow-md max-w-2xl mx-auto" },
                React.createElement('div', { className: "h-80 overflow-y-auto bg-gray-100 p-4 rounded-lg space-y-4 mb-4 flex flex-col" },
                    messages.map((msg, index) => (
                        React.createElement('div', { key: index, className: `flex ${msg.author === 'user' ? 'justify-end' : 'justify-start'}` },
                            React.createElement('div', { className: `max-w-xs md:max-w-md lg:max-w-lg px-4 py-2 rounded-2xl ${msg.author === 'user' ? 'bg-blue-500 text-white' : 'bg-gray-300 text-gray-800'}` },
                                msg.text
                            )
                        )
                    )),
                     isLoading && (
                        React.createElement('div', { className: "flex justify-start" },
                            React.createElement('div', { className: "bg-gray-300 text-gray-800 px-4 py-2 rounded-2xl" },
                               React.createElement('span', { className: "animate-pulse" }, "กำลังพิมพ์...")
                            )
                        )
                    )
                ),
                isFinished ? (
                     React.createElement('div', { className: "text-center p-4 bg-green-100 rounded-lg" },
                        React.createElement('h3', { className: "font-bold text-green-800" }, "จบการจำลองสถานการณ์!"),
                        React.createElement('p', { className: "text-green-700 mt-2" }, "ยอดเยี่ยม! การตั้งคำถามและไม่หลงเชื่อโดยง่ายเป็นทักษะที่สำคัญในการป้องกันตัวเอง"),
                        React.createElement('button', { onClick: onComplete, className: "mt-4 bg-blue-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-600 transition-colors" },
                            "เยี่ยมเลย!"
                        )
                    )
                ) : (
                    React.createElement('form', { onSubmit: handleSendMessage, className: "flex space-x-2" },
                        React.createElement('input', {
                            type: "text",
                            value: userInput,
                            onChange: (e) => setUserInput(e.target.value),
                            placeholder: "พิมพ์คำตอบของคุณ...",
                            className: "flex-grow border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500",
                            disabled: isLoading
                        }),
                        React.createElement('button', { type: "submit", className: "bg-blue-500 text-white font-semibold px-4 py-2 rounded-lg hover:bg-blue-600 disabled:bg-blue-300", disabled: isLoading },
                            "ส่ง"
                        )
                    )
                )
            );
        };

        const PasswordCheckerActivity = ({ onComplete }) => {
            const [password, setPassword] = useState('');

            const checks = useMemo(() => {
                const length = password.length >= 8;
                const uppercase = /[A-Z]/.test(password);
                const lowercase = /[a-z]/.test(password);
                const number = /[0-9]/.test(password);
                const symbol = /[^A-Za-z0-9]/.test(password);
                return { length, uppercase, lowercase, number, symbol };
            }, [password]);

            const strengthScore = Object.values(checks).filter(Boolean).length;
            const isStrong = strengthScore >= 4;
            
            const strengthColor = () => {
                if (strengthScore <= 1) return 'bg-red-500';
                if (strengthScore <= 3) return 'bg-yellow-500';
                return 'bg-green-500';
            };

            const CheckItem = ({ met, text }) => (
                React.createElement('li', { className: `flex items-center transition-colors ${met ? 'text-green-600' : 'text-gray-500'}` },
                    met ? React.createElement(CheckCircleIcon, { className: "w-5 h-5 mr-2" }) : React.createElement(XCircleIcon, { className: "w-5 h-5 mr-2 text-gray-300" }),
                    text
                )
            );

            return React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md" },
                React.createElement('input', {
                    type: "text",
                    value: password,
                    onChange: (e) => setPassword(e.target.value),
                    placeholder: "พิมพ์รหัสผ่านเพื่อทดสอบ...",
                    className: "w-full border-gray-300 rounded-lg p-3 text-lg focus:ring-blue-500 focus:border-blue-500 mb-4"
                }),
                React.createElement('div', { className: "w-full bg-gray-200 rounded-full h-2.5 mb-4" },
                    React.createElement('div', { className: `h-2.5 rounded-full transition-all duration-300 ${strengthColor()}`, style: { width: `${strengthScore * 20}%` } })
                ),
                React.createElement('ul', { className: "space-y-2 mb-6" },
                    React.createElement(CheckItem, { met: checks.length, text: "มีความยาวอย่างน้อย 8 ตัวอักษร" }),
                    React.createElement(CheckItem, { met: checks.uppercase, text: "มีตัวอักษรพิมพ์ใหญ่ (A-Z)" }),
                    React.createElement(CheckItem, { met: checks.lowercase, text: "มีตัวอักษรพิมพ์เล็ก (a-z)" }),
                    React.createElement(CheckItem, { met: checks.number, text: "มีตัวเลข (0-9)" }),
                    React.createElement(CheckItem, { met: checks.symbol, text: "มีสัญลักษณ์พิเศษ (!@#$%)" })
                ),
                React.createElement('div', { className: "text-right" },
                    React.createElement('button', { 
                        onClick: onComplete, 
                        disabled: !isStrong,
                        className: "bg-blue-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed"
                    },
                        isStrong ? 'ยอดเยี่ยม! ไปต่อเลย' : 'ต้องเป็นรหัสผ่านที่คาดเดายาก'
                    )
                )
            );
        };

        const ShareSortGame = ({ onComplete }) => {
            const items = useMemo(() => [
                { text: "ชื่อ-นามสกุลจริง", shouldShare: false },
                { text: "สีที่ชอบ", shouldShare: true },
                { text: "ที่อยู่บ้าน", shouldShare: false },
                { text: "เลขบัตรประชาชน", shouldShare: false },
                { text: "ชื่อสัตว์เลี้ยง", shouldShare: true },
                { text: "รหัสผ่านอีเมล", shouldShare: false },
                { text: "โรงเรียนที่เรียนอยู่", shouldShare: true },
                { text: "รูปถ่ายตอนไปเที่ยวกับครอบครัว", shouldShare: true },
                { text: "ข้อมูลบัตรเครดิตของผู้ปกครอง", shouldShare: false },
            ], []);
            
            const [currentIndex, setCurrentIndex] = useState(0);
            const [score, setScore] = useState(0);
            const [showFeedback, setShowFeedback] = useState(null);

            const handleChoice = (choice) => {
                if (showFeedback) return;
                const isCorrect = choice === items[currentIndex].shouldShare;
                if(isCorrect) setScore(score + 1);
                setShowFeedback({correct: isCorrect, choice});
                
                setTimeout(() => {
                    setShowFeedback(null);
                    setCurrentIndex(currentIndex + 1);
                }, 1500);
            };

            if (currentIndex >= items.length) {
                return React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md text-center" },
                    React.createElement('h3', { className: "text-2xl font-bold text-gray-800" }, "จบเกมแล้ว!"),
                    React.createElement('p', { className: "text-lg text-gray-600 mt-2" }, `คุณได้คะแนน ${score} จาก ${items.length} คะแนน`),
                    React.createElement('div', { className: "my-4" },
                        React.createElement(TrophyIcon, { className: "w-16 h-16 text-yellow-500 mx-auto" })
                    ),
                    React.createElement('p', { className: "text-gray-500" }, "การรู้ว่าข้อมูลไหนควรแชร์หรือไม่แชร์เป็นสิ่งสำคัญมากในการปกป้องตัวเอง"),
                    React.createElement('button', { onClick: onComplete, className: "mt-6 bg-blue-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-600 transition-colors" }, "ไปต่อ")
                );
            }

            return React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md text-center" },
                React.createElement('p', { className: "text-sm text-gray-500 mb-2" }, `คำถามที่ ${currentIndex + 1} / ${items.length}`),
                React.createElement('div', { className: "bg-blue-100 text-blue-800 font-semibold p-6 rounded-lg mb-6 text-2xl" },
                    items[currentIndex].text
                ),
                React.createElement('p', { className: "mb-4 text-gray-700" }, "ข้อมูลนี้... ควรแชร์บนโลกออนไลน์หรือไม่?"),
                React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 gap-4" },
                    React.createElement('button', { onClick: () => handleChoice(true), disabled: !!showFeedback, className: `p-4 rounded-lg font-bold text-lg transition-transform transform hover:scale-105 disabled:opacity-50 ${showFeedback && showFeedback.choice === true ? (showFeedback.correct ? 'bg-green-500' : 'bg-red-500') : 'bg-green-200'} text-green-800` }, "✅ ควรแชร์"),
                    React.createElement('button', { onClick: () => handleChoice(false), disabled: !!showFeedback, className: `p-4 rounded-lg font-bold text-lg transition-transform transform hover:scale-105 disabled:opacity-50 ${showFeedback && showFeedback.choice === false ? (showFeedback.correct ? 'bg-green-500' : 'bg-red-500') : 'bg-red-200'} text-red-800` }, "❌ ไม่ควรแชร์")
                ),
                showFeedback && (
                     React.createElement('p', { className: `mt-4 font-semibold animate-pulse ${showFeedback.correct ? 'text-green-600' : 'text-red-600'}` },
                        showFeedback.correct ? 'ถูกต้อง!' : 'ผิดแล้ว! ข้อมูลนี้เป็นส่วนตัวมากนะ'
                    )
                )
            );
        };

        const BudgetGame = ({ onComplete }) => {
            const weeklyBudget = 500;
            const items = useMemo(() => [
                { name: "ค่าอาหารกลางวัน (5 วัน)", cost: 250, type: 'need' },
                { name: "ค่าเดินทาง", cost: 100, type: 'need' },
                { name: "ตั๋วหนังรอบใหม่", cost: 200, type: 'want' },
                { name: "เสื้อยืดตัวใหม่", cost: 350, type: 'want' },
                { name: "ชานมไข่มุก", cost: 50, type: 'want' },
                { name: "หนังสือการ์ตูน", cost: 80, type: 'want' },
                { name: "สมุดและปากกา", cost: 60, type: 'need' },
            ], []);

            const [spent, setSpent] = useState(0);
            const [purchases, setPurchases] = useState([]);
            const remaining = weeklyBudget - spent;
            
            const handlePurchase = (item) => {
                if (remaining >= item.cost) {
                    setSpent(spent + item.cost);
                    setPurchases([...purchases, item.name]);
                } else {
                    alert("เงินไม่พอแล้ว!");
                }
            };
            
            return React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md" },
                React.createElement('div', { className: "text-center mb-6 p-4 bg-green-100 rounded-lg" },
                    React.createElement('h3', { className: "text-lg font-semibold text-green-800" }, "💰 งบประมาณสัปดาห์นี้"),
                    React.createElement('p', { className: "text-4xl font-bold text-green-600" }, `${remaining.toLocaleString()} บาท`),
                    React.createElement('p', { className: "text-sm text-gray-500" }, `ใช้ไปแล้ว: ${spent.toLocaleString()} บาท`)
                ),
                React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-6" },
                    React.createElement('div', null,
                        React.createElement('h4', { className: "text-xl font-bold mb-3 text-red-600" }, "🚨 ของจำเป็น (Needs)"),
                        React.createElement('div', { className: "space-y-2" },
                            items.filter(i => i.type === 'need').map(item => (
                                React.createElement('button', { key: item.name, onClick: () => handlePurchase(item), disabled: purchases.includes(item.name) || remaining < item.cost, className: "w-full flex justify-between items-center p-3 bg-red-50 rounded-lg border border-red-200 disabled:opacity-40 disabled:cursor-not-allowed hover:bg-red-100" },
                                    React.createElement('span', null, item.name),
                                    React.createElement('span', { className: "font-semibold" }, `${item.cost} บ.`)
                                )
                            ))
                        )
                    ),
                    React.createElement('div', null,
                        React.createElement('h4', { className: "text-xl font-bold mb-3 text-blue-600" }, "✨ ของที่อยากได้ (Wants)"),
                        React.createElement('div', { className: "space-y-2" },
                            items.filter(i => i.type === 'want').map(item => (
                                 React.createElement('button', { key: item.name, onClick: () => handlePurchase(item), disabled: purchases.includes(item.name) || remaining < item.cost, className: "w-full flex justify-between items-center p-3 bg-blue-50 rounded-lg border border-blue-200 disabled:opacity-40 disabled:cursor-not-allowed hover:bg-blue-100" },
                                    React.createElement('span', null, item.name),
                                    React.createElement('span', { className: "font-semibold" }, `${item.cost} บ.`)
                                )
                            ))
                        )
                    )
                ),
                React.createElement('div', { className: "mt-8 text-center" },
                     React.createElement('p', { className: "text-gray-600 mb-4" }, "ลองวางแผนการใช้เงินของคุณให้ดีที่สุด!"),
                    React.createElement('button', { onClick: onComplete, className: "bg-blue-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-600 transition-colors" }, "จบสัปดาห์นี้")
                )
            );
        };

        const DefaultActivity = ({ activity, onComplete }) => (
            React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md text-center" },
                React.createElement('p', { className: "text-gray-700 mb-4" }, `กิจกรรมประเภท '${activity.gameType || activity.type}' กำลังอยู่ในระหว่างการพัฒนา`),
                React.createElement('button', { onClick: onComplete, className: "bg-blue-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-600 transition-colors" }, "ข้ามไปก่อน")
            )
        );

        const ActivityRenderer = ({ activity, onComplete }) => {
          switch (activity.type) {
            case ActivityType.Info:
              return React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md" },
                Array.isArray(activity.content) ?
                  React.createElement('ul', { className: "space-y-3 list-disc list-inside text-gray-700" },
                    activity.content.map((item, index) => React.createElement('li', { key: index }, item))
                  ) :
                  React.createElement('p', { className: "text-gray-700" }, activity.content),
                React.createElement('div', { className: "text-right mt-6" },
                  React.createElement('button', { onClick: onComplete, className: "bg-blue-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-600 transition-colors" }, "เข้าใจแล้ว")
                )
              );
            case ActivityType.Quiz:
              return activity.questions ? React.createElement(QuizActivity, { questions: activity.questions, onComplete: onComplete }) : React.createElement(DefaultActivity, { activity, onComplete });
            case ActivityType.Simulation:
              return React.createElement(ChatSimulationActivity, { onComplete: onComplete });
            case ActivityType.Reflection:
              return React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md" },
                React.createElement('textarea', { 
                    className: "w-full h-40 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",
                    placeholder: "เขียนบันทึกของคุณที่นี่..."
                }),
                React.createElement('div', { className: "text-right mt-4" },
                    React.createElement('button', { onClick: onComplete, className: "bg-blue-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-600 transition-colors" }, "บันทึกและทำกิจกรรมถัดไป")
                )
              );
            case ActivityType.Project:
              return React.createElement('div', { className: "bg-white p-6 rounded-lg shadow-md text-center" },
                 React.createElement('p', { className: "text-gray-700 mb-4" }, activity.description),
                 React.createElement('p', { className: "text-sm text-gray-500 mb-6" }, "ลองสร้างผลงานของคุณเองนอกแอปพลิเคชันนี้ แล้วกลับมากด 'เสร็จสิ้น'"),
                React.createElement('button', { onClick: onComplete, className: "bg-blue-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-600 transition-colors" }, "เสร็จสิ้น")
              );
            case ActivityType.Workshop:
              switch(activity.gameType) {
                  case 'passwordChecker': return React.createElement(PasswordCheckerActivity, { onComplete: onComplete });
                  default: return React.createElement(DefaultActivity, { activity, onComplete });
              }
            case ActivityType.Game:
              switch(activity.gameType) {
                  case 'shareSort': return React.createElement(ShareSortGame, { onComplete: onComplete });
                  case 'budget': return React.createElement(BudgetGame, { onComplete: onComplete });
                  default: return React.createElement(DefaultActivity, { activity, onComplete });
              }
            default:
              return React.createElement(DefaultActivity, { activity, onComplete });
          }
        };
        // --- End: components/ActivityRenderer.tsx ---

        // --- Start: components/ModuleCard.tsx ---
        const ModuleCard = ({ module, onSelect, isCompleted }) => {
          const Icon = module.icon;
          return React.createElement('div', { className: "bg-white border border-gray-200 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 flex flex-col overflow-hidden" },
            React.createElement('div', { className: "bg-slate-100 p-6 flex justify-center items-center" },
              React.createElement(Icon, { className: "h-20 w-20 text-blue-500" })
            ),
            React.createElement('div', { className: "p-6 flex flex-col flex-grow" },
              React.createElement('h3', { className: "text-sm font-semibold text-blue-600 uppercase tracking-wide" }, `หน่วยที่ ${module.id}`),
              React.createElement('h2', { className: "text-2xl font-bold text-gray-800 mt-1" }, module.title),
              React.createElement('p', { className: "text-gray-500 mt-2 flex-grow" }, module.subtitle),
              React.createElement('button', {
                  onClick: () => onSelect(module.id),
                  className: `mt-6 w-full text-white font-semibold py-3 px-4 rounded-lg transition-colors duration-300 flex items-center justify-center ${
                    isCompleted
                      ? 'bg-green-500 hover:bg-green-600'
                      : 'bg-blue-500 hover:bg-blue-600'
                  }`
                },
                isCompleted && React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", className: "h-5 w-5 mr-2", viewBox: "0 0 20 20", fill: "currentColor" },
                  React.createElement('path', { fillRule: "evenodd", d: "M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z", clipRule: "evenodd" })
                ),
                isCompleted ? 'ทบทวนบทเรียน' : 'เริ่มบทเรียน'
              )
            )
          );
        };
        // --- End: components/ModuleCard.tsx ---

        // --- Start: components/ModuleView.tsx ---
        const ModuleView = ({ module, onBack, onModuleComplete, completedActivities }) => {
          const [currentActivityIndex, setCurrentActivityIndex] = useState(0);

          const handleCompleteActivity = () => {
            if (currentActivityIndex < module.activities.length - 1) {
              setCurrentActivityIndex(currentActivityIndex + 1);
            } else {
              onModuleComplete(module.id);
            }
          };

          const currentActivity = module.activities[currentActivityIndex];
          const isModuleFinished = currentActivityIndex >= module.activities.length - 1;

          return React.createElement('div', { className: "max-w-4xl mx-auto p-4 sm:p-6 lg:p-8" },
            React.createElement('button', { onClick: onBack, className: "flex items-center text-blue-600 hover:text-blue-800 font-semibold mb-6" },
              React.createElement(ArrowLeftIcon, { className: "w-5 h-5 mr-2" }),
              "กลับไปหน้าหลัก"
            ),
            React.createElement('div', { className: "bg-white rounded-xl shadow-lg p-6 mb-8" },
              React.createElement('div', { className: "flex items-start space-x-4" },
                React.createElement('div', { className: "bg-blue-100 p-3 rounded-full" },
                  React.createElement(module.icon, { className: "w-10 h-10 text-blue-600" })
                ),
                React.createElement('div', null,
                  React.createElement('h1', { className: "text-3xl font-bold text-gray-800" }, module.title),
                  React.createElement('p', { className: "text-gray-600 mt-1" }, module.objective)
                )
              )
            ),
            React.createElement('div', { className: "relative pl-8" },
              React.createElement('div', { className: "absolute left-4 top-2 bottom-2 w-0.5 bg-gray-200" }),
              module.activities.map((activity, index) => (
                React.createElement('div', { key: index, className: "mb-8" },
                  React.createElement('div', { className: "flex items-center" },
                    React.createElement('div', { className: `absolute left-0 transform translate-x-[-0.85rem] h-8 w-8 rounded-full flex items-center justify-center z-10 ${
                      index < currentActivityIndex || completedActivities.length === module.activities.length ? 'bg-green-500' : 
                      index === currentActivityIndex ? 'bg-blue-500' : 'bg-gray-300'
                    }`},
                      index < currentActivityIndex || completedActivities.length === module.activities.length ? 
                        React.createElement(CheckCircleIcon, { className: "w-5 h-5 text-white" }) :
                        React.createElement('span', { className: "text-white font-bold" }, index + 1)
                    ),
                    React.createElement('h3', { className: `text-xl font-semibold ${index <= currentActivityIndex ? 'text-gray-800' : 'text-gray-400'}` },
                      activity.title
                    )
                  ),
                  React.createElement('div', { className: `pl-4 mt-2 transition-all duration-500 ease-in-out ${index === currentActivityIndex ? 'max-h-full opacity-100' : 'max-h-0 opacity-0 overflow-hidden'}` },
                      index === currentActivityIndex && (
                          React.createElement('div', { className: "pt-4" },
                            React.createElement('p', { className: "text-gray-600 mb-4" }, activity.description),
                            React.createElement(ActivityRenderer, { activity: activity, onComplete: handleCompleteActivity })
                          )
                      )
                  )
                )
              ))
            ),
            isModuleFinished && (
              React.createElement('div', { className: "mt-8 p-6 bg-green-100 border-l-4 border-green-500 rounded-r-lg" },
                React.createElement('h3', { className: "text-2xl font-bold text-green-800" }, "บทเรียนเสร็จสมบูรณ์!"),
                React.createElement('p', { className: "text-green-700 mt-2" }, "ยอดเยี่ยมมาก! คุณได้เรียนรู้ทักษะสำคัญในการป้องกันตัวเองในโลกดิจิทัลแล้ว"),
                React.createElement('button', { onClick: onBack, className: "mt-4 bg-green-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-700 transition-colors" }, "กลับไปหน้าหลัก")
              )
            )
          );
        };
        // --- End: components/ModuleView.tsx ---

        // --- Start: components/LoginPage.tsx ---
        const defaultAvatar = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBmaWxsPSJub25lIiBzdHJva2U9IiM2YjcyODAiIHN0cm9rZS13aWR0aD0iOCI+PGNpcmNsZSBjeD0iNTAiIGN5PSIzNSIgcj0iMTgiLz48cGF0aCBkPSJNMTUgOTAgQyAxNSA3MCwgODUgNzAsIDg1IDkwIiBzdHJva2UtbGluZWNhcD0icm91bmQiLz48L3N2Zz4=';

        const LoginPage = ({ onLogin }) => {
          const [title, setTitle] = useState('เด็กชาย');
          const [fullName, setFullName] = useState('');
          const [studentId, setStudentId] = useState('');
          const [profilePicture, setProfilePicture] = useState(null);
          const [isFormValid, setIsFormValid] = useState(false);

          useEffect(() => {
            setIsFormValid(!!(title && fullName.trim() && studentId.trim()));
          }, [title, fullName, studentId]);

          const handlePictureUpload = (e) => {
            if (e.target.files && e.target.files[0]) {
              const file = e.target.files[0];
              const reader = new FileReader();
              reader.onloadend = () => {
                setProfilePicture(reader.result);
              };
              reader.readAsDataURL(file);
            }
          };

          const handleSubmit = (e) => {
            e.preventDefault();
            if (isFormValid) {
              onLogin({
                title,
                fullName,
                studentId,
                profilePicture: profilePicture || defaultAvatar,
              });
            }
          };

          return React.createElement('div', { className: "min-h-screen flex flex-col justify-center items-center p-4" },
              React.createElement('div', { className: "text-center mb-8" },
                  React.createElement('svg', { className: "h-16 w-16 text-blue-600 mx-auto", xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor" },
                    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" })
                  ),
                  React.createElement('h1', { className: "text-4xl font-bold text-gray-900 mt-4" }, "เกราะป้องกันการเงินดิจิทัล"),
                  React.createElement('p', { className: "text-lg text-gray-600 mt-2" }, "โปรดกรอกข้อมูลเพื่อเริ่มต้นการเรียนรู้")
              ),
            React.createElement('div', { className: "max-w-md w-full bg-white rounded-xl shadow-lg p-8 space-y-6" },
              React.createElement('form', { onSubmit: handleSubmit, className: "space-y-6" },
                React.createElement('div', { className: "flex flex-col items-center" },
                  React.createElement('label', { htmlFor: "picture-upload", className: "cursor-pointer" },
                    React.createElement('div', { className: "w-32 h-32 rounded-full bg-gray-200 border-4 border-dashed border-gray-300 hover:border-blue-500 flex items-center justify-center transition-all" },
                      profilePicture ? 
                        React.createElement('img', { src: profilePicture, alt: "Preview", className: "w-full h-full rounded-full object-cover" }) :
                        React.createElement('div', { className: "text-center text-gray-500" },
                          React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", className: "h-10 w-10 mx-auto", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor", strokeWidth: 1 },
                            React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" }),
                            React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M15 13a3 3 0 11-6 0 3 3 0 016 0z" })
                          ),
                          React.createElement('span', { className: "text-sm mt-1" }, "อัปโหลดรูปภาพ")
                        )
                    )
                  ),
                  React.createElement('input', { id: "picture-upload", type: "file", accept: "image/*", className: "hidden", onChange: handlePictureUpload })
                ),
                React.createElement('div', null,
                  React.createElement('label', { htmlFor: "title", className: "block text-sm font-medium text-gray-700" }, "คำนำหน้าชื่อ"),
                  React.createElement('select', { id: "title", value: title, onChange: (e) => setTitle(e.target.value), className: "mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" },
                    React.createElement('option', null, "เด็กชาย"),
                    React.createElement('option', null, "เด็กหญิง"),
                    React.createElement('option', null, "นาย"),
                    React.createElement('option', null, "นาง"),
                    React.createElement('option', null, "นางสาว")
                  )
                ),
                React.createElement('div', null,
                  React.createElement('label', { htmlFor: "fullName", className: "block text-sm font-medium text-gray-700" }, "ชื่อ - สกุล"),
                  React.createElement('input', { type: "text", id: "fullName", value: fullName, onChange: (e) => setFullName(e.target.value), required: true, className: "mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500", placeholder: "สมชาย ใจดี" })
                ),
                React.createElement('div', null,
                  React.createElement('label', { htmlFor: "studentId", className: "block text-sm font-medium text-gray-700" }, "เลขที่"),
                  React.createElement('input', { type: "text", id: "studentId", value: studentId, onChange: (e) => setStudentId(e.target.value), required: true, className: "mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500", placeholder: "เช่น 99" })
                ),
                React.createElement('div', null,
                  React.createElement('button', { type: "submit", disabled: !isFormValid, className: "w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-lg font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors" }, "เริ่มเรียน")
                )
              )
            ),
             React.createElement('footer', { className: "text-center text-gray-500 mt-8" },
                 React.createElement('p', null, `© ${new Date().getFullYear()} Digital Financial Shield. สร้างขึ้นเพื่อการเรียนรู้`)
            )
          );
        };
        // --- End: components/LoginPage.tsx ---

        // --- Start: App.tsx ---
        const App = () => {
          const [modulesData] = useState(modules);
          const [selectedModuleId, setSelectedModuleId] = useState(null);
          const [user, setUser] = useState(null);

          const [userProgress, setUserProgress] = useState(() => {
            try {
              const savedProgress = localStorage.getItem('userProgress');
              return savedProgress ? JSON.parse(savedProgress) : { completedActivities: {}, badges: [], quizScores: {} };
            } catch (error) {
              console.error("Failed to parse userProgress from localStorage. Resetting to default.", error);
              return { completedActivities: {}, badges: [], quizScores: {} };
            }
          });

          useEffect(() => {
            try {
              const savedUser = localStorage.getItem('dfs_user');
              if (savedUser) {
                  setUser(JSON.parse(savedUser));
              }
            } catch (error) {
                console.error("Failed to parse user from localStorage. Clearing corrupted data.", error);
                localStorage.removeItem('dfs_user');
            }
          }, []);

          useEffect(() => {
            localStorage.setItem('userProgress', JSON.stringify(userProgress));
          }, [userProgress]);

          const handleLogin = (userData) => {
            localStorage.setItem('dfs_user', JSON.stringify(userData));
            setUser(userData);
          };
          
          const handleLogout = () => {
              localStorage.removeItem('dfs_user');
              setUser(null);
              setSelectedModuleId(null);
          }

          const handleSelectModule = (id) => {
            setSelectedModuleId(id);
          };

          const handleBackToHome = () => {
            setSelectedModuleId(null);
          };
          
          const handleModuleComplete = (moduleId) => {
            const module = modulesData.find(m => m.id === moduleId);
            if (!module) return;

            setUserProgress(prev => ({
                ...prev,
                completedActivities: {
                    ...prev.completedActivities,
                    [moduleId]: module.activities.map((_, index) => index)
                }
            }));
          };

          if (!user) {
            return React.createElement(LoginPage, { onLogin: handleLogin });
          }

          const selectedModule = modulesData.find(m => m.id === selectedModuleId);

          return React.createElement('div', { className: "min-h-screen text-gray-800" },
            React.createElement('header', { className: "bg-white shadow-md sticky top-0 z-50" },
              React.createElement('div', { className: "container mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center" },
                React.createElement('div', { className: "flex items-center space-x-3" },
                  React.createElement('svg', { className: "h-10 w-10 text-blue-600", xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: "1.5", stroke: "currentColor" },
                    React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" })
                  ),
                  React.createElement('h1', { className: "text-xl sm:text-2xl font-bold text-gray-900" }, "เกราะป้องกันการเงินดิจิทัล")
                ),
                React.createElement('div', { className: "flex items-center space-x-4" },
                  React.createElement('div', { className: "text-right" },
                    React.createElement('p', { className: "font-semibold text-gray-800 text-sm sm:text-base" }, user.fullName),
                    React.createElement('p', { className: "text-xs text-gray-500" }, `เลขที่: ${user.studentId}`)
                  ),
                  React.createElement('img', { src: user.profilePicture, alt: "Profile", className: "w-12 h-12 rounded-full object-cover border-2 border-blue-500" }),
                  React.createElement('button', { onClick: handleLogout, className: "text-gray-500 hover:text-red-600", 'aria-label': "ออกจากระบบ" },
                    React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", className: "h-6 w-6", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor", strokeWidth: 2 },
                      React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" })
                    )
                  )
                )
              )
            ),
            React.createElement('main', { className: "container mx-auto px-4 sm:px-6 lg:px-8 py-8" },
              selectedModule ? 
                React.createElement(ModuleView, { 
                  module: selectedModule, 
                  onBack: handleBackToHome,
                  onModuleComplete: handleModuleComplete,
                  completedActivities: userProgress.completedActivities[selectedModule.id] || []
                }) :
                React.createElement('div', null,
                  React.createElement('div', { className: "text-center mb-12" },
                    React.createElement('h2', { className: "text-4xl font-extrabold text-gray-900" }, "บทเรียนของคุณ"),
                    React.createElement('p', { className: "mt-3 max-w-2xl mx-auto text-xl text-gray-500" }, "เลือกบทเรียนเพื่อเริ่มต้นสร้างภูมิคุ้มกันทางการเงินและดิจิทัล")
                  ),
                  React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" },
                    modulesData.map(module => 
                      React.createElement(ModuleCard, { 
                          key: module.id, 
                          module: module, 
                          onSelect: handleSelectModule,
                          isCompleted: (userProgress.completedActivities[module.id] || []).length === module.activities.length
                      })
                    )
                  )
                )
            ),
            React.createElement('footer', { className: "bg-white mt-12" },
              React.createElement('div', { className: "container mx-auto py-6 px-4 sm:px-6 lg:px-8 text-center text-gray-500" },
                React.createElement('p', null, `© ${new Date().getFullYear()} Digital Financial Shield. สร้างขึ้นเพื่อการเรียนรู้`)
              )
            )
          );
        };
        // --- End: App.tsx ---

        // --- Start: index.tsx (Mounting Logic) ---
        const rootElement = document.getElementById('root');
        if (!rootElement) {
          throw new Error("Could not find root element to mount to");
        }

        const root = ReactDOM.createRoot(rootElement);
        root.render(
          React.createElement(React.StrictMode, null, React.createElement(App, null))
        );
        // --- End: index.tsx ---

    </script>
</body>
</html>